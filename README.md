# <img src="./assets/icons/dado.svg" width="40" valign="middle"/> N√≥ Customizado "Random Number" para n8n OnFly <img src="./assets/gif/OnFly.gif" width="40" valign="middle"/>

![Vers√£o do n8n](https://img.shields.io/badge/n8n-v1.85.4%2B-%231A82E2?style=for-the-badge&logo=n8n)
![Status](https://img.shields.io/badge/status-conclu%C3%ADdo-brightgreen?style=for-the-badge)
![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)

<p align="center">
  <em>Um conector personalizado para n8n que gera n√∫meros aleat√≥rios utilizando a API da Random.org (Teste T√©cnico OnFly)</em>
</p>

<p align="center">
  <img src="./assets/gif/ExemploFun.gif" alt="Demonstra√ß√£o do N√≥ Random em A√ß√£o" width="80%">
</p>

---

# <img src="./assets/gif/indice.gif" width="40" valign="middle"> √çndice

<table>
  <tr>
    <td width="30px"><img src="./assets/icons/sobre.svg" width="20px"></td>
    <td><a href="#-sobre-o-projeto">üéØ Sobre o Projeto</a></td>
  </tr>
  <tr>
    <td><img src="./assets/icons/tech-usada.svg" width="20px"></td>
    <td><a href="#-tecnologias-utilizadas">üõ†Ô∏è Tecnologias Utilizadas</a></td>
  </tr>
  <tr>
    <td><img src="./assets/icons/preReq.svg" width="20px"></td>
    <td><a href="#-pr√©-requisitos">üìã Pr√©-requisitos</a></td>
  </tr>
  <tr>
    <td><img src="./assets/icons/installExec.svg" width="20px"></td>
    <td><a href="#Ô∏è-instala√ß√£o-e-execu√ß√£o">‚öôÔ∏è Instala√ß√£o e Execu√ß√£o</a></td>
  </tr>
  <tr>
    <td><img src="./assets/icons/teste.svg" width="20px"></td>
    <td><a href="#-como-testar-o-n√≥">üß™ Como Testar o N√≥</a></td>
  </tr>
  <tr>
    <td><img src="./assets/icons/estruturaPasta.svg" width="20px"></td>
    <td><a href="#-estrutura-do-projeto">üìÅ Estrutura do Projeto</a></td>
  </tr>
  <tr>
    <td><img src="./assets/icons/contato.svg" width="20px"></td>
    <td><a href="#-contato">üìû Contato</a></td>
  </tr>
</table>

---

# <img src="./assets/gif/Sobre.gif" width="40" valign="middle"> Sobre o Projeto

Este projeto foi desenvolvido como parte de um **desafio t√©cnico OnFly**. O objetivo foi criar um conector (n√≥) personalizado para a plataforma de automa√ß√£o *low-code* **n8n**.

## üé≤ Funcionalidades Principais

O n√≥ **Random** oferece as seguintes funcionalidades:

- ‚úÖ **Gera√ß√£o de n√∫meros verdadeiramente aleat√≥rios** atrav√©s da API da [Random.org](https://www.random.org/)
- ‚úÖ **Configura√ß√£o de intervalo personalizado** com valores m√≠nimo e m√°ximo
- ‚úÖ **Integra√ß√£o nativa com workflows** do n8n
- ‚úÖ **Suporte a entradas din√¢micas** de n√≥s anteriores
- ‚úÖ **Valida√ß√£o de par√¢metros** e tratamento de erros
- ‚úÖ **Interface visual** com √≠cone personalizado


# <img src="./assets/gif/TechUsada.gif" width="40" valign="middle"/> Tecnologias Utilizadas

| Tecnologia | Vers√£o | Utiliza√ß√£o |
| :--- | :---: | :--- |
| <img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/typescript/typescript-original.svg" alt="TypeScript" width="20" height="20"/> **TypeScript** | `^5.8.2` | Linguagem principal para o desenvolvimento do n√≥ customizado, garantindo tipagem forte e robustez ao c√≥digo. |
| <img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/nodejs/nodejs-original.svg" alt="Node.js" width="20" height="20"/> **Node.js** | `>=20.15` | Ambiente de execu√ß√£o (runtime) para o n8n e para o funcionamento do n√≥ customizado. |
| <img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/docker/docker-original.svg" alt="Docker" width="20" height="20"/> **Docker** | `Latest` | Orquestra√ß√£o dos containers da aplica√ß√£o (n8n) e do banco de dados (PostgreSQL) atrav√©s do Docker Compose. |
| <img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/postgresql/postgresql-original.svg" alt="PostgreSQL" width="20" height="20"/> **PostgreSQL** | `15` | Banco de dados para a inst√¢ncia do n8n, respons√°vel por persistir todos os workflows, credenciais e hist√≥ricos de execu√ß√£o. |
| **n8n** | `Latest` | Plataforma de automa√ß√£o low-code onde o n√≥ customizado √© integrado. |
| **Random.org API** | `v4` | API externa utilizada para gerar n√∫meros verdadeiramente aleat√≥rios. |

---

# <img src="./assets/gif/PreRequisito.gif" width="40" valign="middle"/> Pr√©-requisitos

Antes de come√ßar, voc√™ precisar√° ter as seguintes ferramentas instaladas em sua m√°quina:

## üñ•Ô∏è Requisitos do Sistema

| Ferramenta | Vers√£o M√≠nima | Link de Download | Verifica√ß√£o |
|------------|---------------|------------------|-------------|
| **Git** | `2.0+` | [Download Git](https://git-scm.com) | `git --version` |
| **Docker** | `20.0+` | [Docker Desktop](https://www.docker.com/products/docker-desktop/) | `docker --version` |
| **Docker Compose** | `2.0+` | *J√° inclu√≠do no Docker Desktop* | `docker-compose --version` |

## üîç Verifica√ß√£o dos Pr√©-requisitos

Execute os comandos abaixo para verificar se tudo est√° instalado corretamente:

```bash
# Verificar Git
git --version

# Verificar Docker
docker --version

# Verificar Docker Compose
docker-compose --version

# Verificar se o Docker est√° rodando
docker info
```

**‚ö†Ô∏è Importante**: Certifique-se de que o Docker Desktop esteja **executando** antes de prosseguir com a instala√ß√£o.

---

# <img src="./assets/gif/Config.gif" width="40" valign="middle"/>Ô∏è Instala√ß√£o e Execu√ß√£o

Siga os passos abaixo **rigorosamente** para executar a aplica√ß√£o localmente sem problemas.

## üìã Passo 1: Clone o Reposit√≥rio

```bash
# Clone o reposit√≥rio do projeto
git clone https://github.com/CarlosNeimar/OnFly-Test-Custom-N8N.git

# Navegue para o diret√≥rio raiz do projeto
cd OnFly-Test-Custom-N8N
```

## üì¶ Passo 2: Instale as Depend√™ncias do N√≥

```bash
# Instale as depend√™ncias do Node.js
npm install

# Instale as defini√ß√µes de tipos (importante para evitar erros)
npm install @types/node @types/lodash --save-dev
```

## üî® Passo 3: Compile o Projeto TypeScript

```bash
# Limpe compila√ß√µes anteriores (se existirem)
npm run build

# Verifique se a pasta 'dist' foi criada com sucesso
ls dist/
```

**‚úÖ Resultado esperado**: Uma pasta `dist/` deve ser criada contendo:
```
dist/
‚îî‚îÄ‚îÄ nodes/
    ‚îî‚îÄ‚îÄ Random/
        ‚îú‚îÄ‚îÄ Random.node.js
        ‚îî‚îÄ‚îÄ RandomIcon.svg
```

## üê≥ Passo 4: Configura√ß√£o do Docker

### 4.1 Limpe Containers Anteriores (se existirem)
```bash
# Pare containers em execu√ß√£o (se houver)
docker-compose down

# Remove containers, redes e volumes (limpeza total)
docker-compose down -v --remove-orphans

# Limpe imagens n√£o utilizadas (opcional)
docker system prune -f
```

## üöÄ Passo 5: Inicializa√ß√£o dos Servi√ßos

### 5.1 Subir os Containers
```bash
# Suba os containers em modo detached (segundo plano)
docker-compose up -d
# Aguarde alguns segundos para inicializa√ß√£o completa
```

### 5.2 Verificar Status dos Containers
```bash
# Verifique se os containers est√£o rodando
docker-compose ps

# Verifique os logs do n8n (importante para debug)
docker-compose logs n8n

# Verifique os logs do PostgreSQL
docker-compose logs postgres
```

**‚úÖ Status esperado**:
```
     Name                   Command               State            Ports
--------------------------------------------------------------------------------
project_n8n_1         tini -- /docker-entrypoint.sh   Up      0.0.0.0:5678->5678/tcp
project_postgres_1     docker-entrypoint.sh postgres   Up      5432/tcp
```

## üåê Passo 6: Acesso ao n8n

### 6.1 Acesse a Interface
1. Abra seu navegador web
2. Navegue para: `http://localhost:5678`
3. **Primeira execu√ß√£o**: Crie uma conta de administrador

### 6.2 Verifica√ß√£o do N√≥ Customizado
1. Clique em **"Add workflow"** para criar um novo fluxo
2. Clique no bot√£o **"+"** para adicionar um n√≥
3. Na barra de pesquisa, digite **"Random"**
4. **‚úÖ Sucesso**: O n√≥ "Random" deve aparecer na lista

## üö® Solu√ß√£o de Problemas 

### Problema: "Cannot connect to Docker daemon"
```bash
# Solu√ß√£o: Inicie o Docker Desktop manualmente
# No Windows: Procure "Docker Desktop" no menu iniciar
# No macOS: Procure Docker na barra de aplica√ß√µes
# No Linux: sudo systemctl start docker
```

### Problema: "Port 5678 already in use"
```bash
# Solu√ß√£o: Mate o processo que est√° usando a porta
# Windows:
netstat -ano | findstr :5678
taskkill /PID <PID_NUMBER> /F

# Linux/macOS:
lsof -ti:5678 | xargs kill -9
```

### Problema: N√≥ "Random" n√£o aparece
```bash
# Verifique se a pasta dist existe
ls dist/

# Recompile o projeto
npm run build

# Reinicie os containers
docker-compose restart n8n
```

### Problema: Erro de conex√£o com PostgreSQL
```bash
# Verifique os logs do PostgreSQL
docker-compose logs postgres

# Reinicie apenas o PostgreSQL
docker-compose restart postgres

# Aguarde 30 segundos e reinicie o n8n
docker-compose restart n8n
```

<p align="center"><img src="./assets/icons/correto.svg" width="20px" valign="middle" > <strong>Pronto! O ambiente n8n est√° no ar e o n√≥ customizado Random j√° estar√° dispon√≠vel na paleta de n√≥s para ser usado.</strong></p>

---

# <img src="./assets/gif/Test.gif" width="40" valign="middle"/> Como Testar o N√≥

Para garantir que o n√≥ `Random` est√° funcionando corretamente, siga este tutorial passo a passo para construir um workflow de teste simples dentro do ambiente n8n.

## üß™ Teste B√°sico - Gera√ß√£o Simples

### 1. Crie um Novo Workflow
Na interface do n8n (`http://localhost:5678`), clique em **"Add workflow"** para iniciar um novo fluxo de trabalho em branco.

### 2. Adicione e Configure o N√≥ "Random"
- Clique no √≠cone `+` na tela para abrir a paleta de n√≥s
- Procure por **`Random`** e selecione-o para adicionar ao seu fluxo
- No painel de configura√ß√µes do n√≥ que se abrir√° √† direita, preencha os par√¢metros:
  - **Min**: `10`
  - **Max**: `500`

### 3. Execute o N√≥ e Verifique a Sa√≠da
- Com o n√≥ selecionado, clique no √≠cone de "play" (**Execute Node**) para test√°-lo individualmente
- Ap√≥s a execu√ß√£o, navegue at√© a aba **Output** no painel direito
- Voc√™ dever√° ver o resultado em formato JSON, contendo o n√∫mero aleat√≥rio gerado pela API da Random.org

**‚úÖ Resultado esperado**:
```json
{
  "randomNumber": 247,
  "min": 10,
  "max": 500,
  "timestamp": "2024-XX-XX T XX:XX:XX.XXXZ"
}
```

## üîÑ Teste Avan√ßado - Entradas Din√¢micas

### 1. Adicione um N√≥ "Set"
- Adicione um n√≥ **Set** antes do n√≥ **Random**
- Configure-o com dois campos:
  - `min` (Number): `50`
  - `max` (Number): `150`

### 2. Conecte os N√≥s
- Conecte o n√≥ **Set** ao n√≥ **Random** arrastando da sa√≠da do Set para a entrada do Random

### 3. Configure Express√µes Din√¢micas
Modifique o n√≥ **Random** para usar express√µes que leiam os dados do n√≥ anterior:
- **Min**: `{{ $json.min }}`
- **Max**: `{{ $json.max }}`

### 4. Execute o Workflow Completo
- Execute o workflow completo clicando em **"Execute Workflow"**
- O resultado dever√° ser um n√∫mero aleat√≥rio entre 50 e 150
- Isso confirma que seu n√≥ se integra perfeitamente a outros n√≥s em um fluxo de trabalho

## ‚úÖ Valida√ß√µes de Teste

Execute m√∫ltiplas vezes e verifique:
- [ ] O n√∫mero gerado est√° sempre dentro do intervalo especificado
- [ ] Cada execu√ß√£o produz um n√∫mero diferente (randomiza√ß√£o real)
- [ ] O n√≥ aceita entradas din√¢micas de n√≥s anteriores
- [ ] N√£o h√° erros nos logs do container n8n

---

# <img src="./assets/gif/EstruturaPastas.gif" width="40" valign="middle"/> Estrutura do Projeto

A estrutura de pastas foi organizada da seguinte forma para separar responsabilidades e manter o c√≥digo limpo e escal√°vel:

```
OnFly-Test-Custom-N8N/
‚îÇ
‚îú‚îÄ‚îÄ üìÅ assets/                          # Recursos visuais do projeto
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ gif/                         # Anima√ß√µes GIF para documenta√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Config.gif                  # GIF da configura√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Contact.gif                 # GIF de contato
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EstruturaPastas.gif         # GIF da estrutura
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ indice.gif                  # GIF do √≠ndice
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OnFly.gif                   # GIF da OnFly
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PreRequisito.gif            # GIF dos pr√©-requisitos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sobre.gif                   # GIF sobre o projeto
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TechUsada.gif               # GIF das tecnologias
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Test.gif                    # GIF dos testes
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ icons/                       # √çcones SVG para se√ß√µes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contato.svg                 # √çcone de contato
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ correto.svg                 # √çcone de sucesso
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dado.svg                    # √çcone principal (dado)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ estruturaPasta.svg          # √çcone de estrutura
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ installExec.svg             # √çcone de instala√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ preReq.svg                  # √çcone de pr√©-requisitos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sobre.svg                   # √çcone sobre
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tech-usada.svg              # √çcone de tecnologias
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ teste.svg                   # √çcone de teste
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ images/                      # Imagens gerais do projeto
‚îÇ
‚îú‚îÄ‚îÄ üìÅ src/                             # C√≥digo-fonte principal
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ nodes/                       # Defini√ß√µes dos n√≥s customizados
‚îÇ       ‚îî‚îÄ‚îÄ üìÅ Random/                  # N√≥ de n√∫meros aleat√≥rios
‚îÇ           ‚îú‚îÄ‚îÄ Random.node.ts          # Implementa√ß√£o do n√≥ (TypeScript)
‚îÇ           ‚îî‚îÄ‚îÄ RandomIcon.svg          # √çcone do n√≥ no n8n
‚îÇ
‚îú‚îÄ‚îÄ üìÅ dist/                            # C√≥digo compilado (gerado automaticamente)
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ nodes/                       # N√≥s compilados para JavaScript
‚îÇ       ‚îî‚îÄ‚îÄ üìÅ Random/
‚îÇ           ‚îú‚îÄ‚îÄ Random.node.js          # N√≥ compilado
‚îÇ           ‚îî‚îÄ‚îÄ RandomIcon.svg          # √çcone copiado
‚îÇ
‚îú‚îÄ‚îÄ üìÑ .editorconfig                    # Configura√ß√µes do editor
‚îú‚îÄ‚îÄ üìÑ .eslintrc.js                     # Configura√ß√µes do ESLint
‚îú‚îÄ‚îÄ üìÑ .eslintrc.prepublish.js          # ESLint para pr√©-publica√ß√£o
‚îú‚îÄ‚îÄ üìÑ .gitignore                       # Arquivos ignorados pelo Git
‚îú‚îÄ‚îÄ üìÑ .npmignore                       # Arquivos ignorados pelo NPM
‚îú‚îÄ‚îÄ üìÑ .prettierrc.js                   # Configura√ß√µes do Prettier
‚îú‚îÄ‚îÄ üìÑ docker-compose.yml               # Orquestra√ß√£o dos containers
‚îú‚îÄ‚îÄ üìÑ gulpfile.js                      # Automa√ß√£o de tarefas
‚îú‚îÄ‚îÄ üìÑ index.js                         # Ponto de entrada do pacote
‚îú‚îÄ‚îÄ üìÑ package.json                     # Depend√™ncias e scripts NPM
‚îú‚îÄ‚îÄ üìÑ package-lock.json                # Lock das depend√™ncias
‚îú‚îÄ‚îÄ üìÑ README.md                        # Documenta√ß√£o do projeto
‚îú‚îÄ‚îÄ üìÑ tsconfig.json                    # Configura√ß√µes TypeScript
‚îî‚îÄ‚îÄ üìÑ tsconfig.tsbuildinfo             # Cache de compila√ß√£o TS
```

## üîç Detalhamento dos Diret√≥rios Principais

### üìÅ `src/nodes/Random/`
**Prop√≥sito**: Cont√©m o c√≥digo-fonte do n√≥ customizado
- `Random.node.ts`: Classe principal que implementa a interface `INodeType` do n8n
- `RandomIcon.svg`: √çcone visual que aparece na paleta de n√≥s do n8n

### üìÅ `dist/`
**Prop√≥sito**: C√≥digo TypeScript compilado para JavaScript
- Gerado automaticamente pelo comando `npm run build`
- √â este diret√≥rio que √© mapeado para dentro do container Docker

### üìÅ `assets/`
**Prop√≥sito**: Recursos visuais e de documenta√ß√£o
- **GIFs**: Anima√ß√µes explicativas para o README
- **Icons**: √çcones SVG para organiza√ß√£o visual da documenta√ß√£o
- **Images**: Screenshots e imagens de apoio

### üìÑ Arquivos de Configura√ß√£o

| Arquivo | Finalidade |
|---------|------------|
| `package.json` | Defini√ß√µes do pacote NPM, depend√™ncias e scripts |
| `tsconfig.json` | Configura√ß√µes de compila√ß√£o TypeScript |
| `docker-compose.yml` | Defini√ß√£o dos containers (n8n + PostgreSQL) |
| `.eslintrc.js` | Regras de qualidade e estilo de c√≥digo |
| `.prettierrc.js` | Formata√ß√£o autom√°tica de c√≥digo |

---

# <img src="./assets/gif/Contact.gif" width="40" valign="middle"/> Contato

Desenvolvido por **Carlos Neimar** como parte do desafio t√©cnico OnFly.

üìß **E-mail**: carlos.areas@sga.pucminas.br  
üêô **GitHub**: [@CarlosNeimar](https://github.com/CarlosNeimar)  
üîó **LinkedIn**: [Carlos Neimar](https://linkedin.com/in/carlosneimar)  

---


<p align="center">
  <em>Desenvolvido para o desafio OnFly</em>
</p>
